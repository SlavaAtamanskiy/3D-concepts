var font_source="https://raw.githubusercontent.com/SlavaAtamanskiy/3D-concepts/development/js/helvetiker_bold.typeface.json";var alphabet="A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z";var renderer,scene,camera,clock,position,status="";var world,hero;var worldSpeed=Math.PI/800;var worldRadius=2000;var heroSpeed=Math.PI/35;var heroAxisY=-115;var jumping;var gravity=0;var bounce=0.5;var pace=150;var paceCount=2;var leftLane=-(pace);var rightLane=pace;var middleLane=0;var currentLane;var symbolsInPath=[];var symbols=[];var particleGeometry;var particleCount=20;var explosionPower=1.06;var particles;function startGame(){var c=document.getElementById("canvas");var d=window.innerWidth;var a=window.innerHeight;c.setAttribute("width",d);c.setAttribute("height",a);renderer=new THREE.WebGLRenderer({canvas:c,alpha:true});renderer.setClearColor(16775930,1);renderer.setPixelRatio=window.devicePixelRatio;renderer.shadowMap.enabled=true;renderer.shadowMap.type=THREE.PCFSoftShadowMap;scene=new THREE.Scene();camera=new THREE.PerspectiveCamera(40,d/a,0.1,1000);camera.position.set(0,0,375);var b=new THREE.AmbientLight(16777215,0.5);var e=new THREE.PointLight(16777215,0.5);scene.add(b);scene.add(e);clock=new THREE.Clock();clock.start();position=new THREE.Spherical();addDevTools();addWorld();addHero();addExplosion();createSymbols();document.onkeydown=handleKeyDown}function loop(){world.rotation.x+=worldSpeed;hero.rotation.x-=heroSpeed;addHeroMoves();renderer.render(scene,camera);requestAnimationFrame(function(){loop()})}function handleKeyDown(a){if(jumping){return}if(a.keyCode===32){bounce=5;jumping=true;return}if(a.keyCode===37&&currentLane!==-(pace*paceCount)){currentLane-=pace}else{if(a.keyCode===39&&currentLane!==pace*paceCount){currentLane+=pace}}}function createSymbols(){var b=alphabet.split(",");var d=b.length;var e=[];var c=0;var a=new THREE.FontLoader();a.load(font_source,function(h){while(c<d){var g=b[Math.floor(Math.random()*d)];var f=e.find(function(i){return i===g});if(f===undefined){symbols.push(createSymbol(g,h));e.push(g);c++}}})}function createSymbol(d,c){var e=new THREE.MeshPhongMaterial({color:8776695});var f=new THREE.TextGeometry(d,{font:c,size:100,height:50,curveSegments:12,bevelThickness:1,bevelSize:1,bevelEnabled:true});var b=new THREE.Mesh(f,e);f.computeBoundingBox();f.textWidth=f.boundingBox.max.x-f.boundingBox.min.x;position.set(worldRadius,1.7,world.rotation.x+=20);b.position.setFromSpherical(position);var a=world.position.clone().normalize();var g=b.position.clone().normalize();b.quaternion.setFromUnitVectors(g,a);world.add(b);return b}function addHero(){var b=new THREE.DodecahedronGeometry(35,1);var a=new THREE.MeshStandardMaterial({color:15069938,shading:THREE.FlatShading});jumping=false;hero=new THREE.Mesh(b,a);hero.receiveShadow=true;hero.castShadow=true;scene.add(hero);hero.position.set(0,heroAxisY,-100);currentLane=middleLane;hero.position.x=currentLane}function addWorld(){var e=200;var a=200;var h=new THREE.SphereGeometry(worldRadius,e,a);var c=new THREE.MeshStandardMaterial({color:65280,shading:THREE.FlatShading,wireframe:false});var d=80;if(clock.running){clock.stop()}clock.start();var g=1;var f=0;for(var b=0;b<h.vertices.length;b++){f+=20*clock.getDelta()*g;if(d<Math.abs(f)){g=g*(-1)}h.vertices[b].x+=-10+Math.random()*20*f;h.vertices[b].y+=-10+Math.random()*20*f}world=new THREE.Mesh(h,c);world.rotation.z=90;world.position.set(0,-2000,-800);world.receiveShadow=true;world.castShadow=true;scene.add(world)}function addHeroMoves(){hero.position.x=THREE.Math.lerp(hero.position.x,currentLane,2*clock.getDelta());if(jumping){if(status==="decreasing"){gravity-=0.06;hero.position.y-=(bounce-gravity);if(hero.position.y<heroAxisY){hero.position.y=heroAxisY;bounce=0.5;jumping=false;status=""}}else{if(status!=="decreasing"){gravity+=0.06;if(bounce-gravity<0){status="decreasing"}hero.position.y+=(bounce-gravity)}}return}hero.position.y+=bounce;var a=45;if(Math.abs(hero.position.y)<Math.abs(heroAxisY)-a){hero.position.y=heroAxisY}if(Math.abs(hero.position.y)<Math.abs(heroAxisY)-Math.floor(Math.random()*a)){hero.position.y=heroAxisY}}function addExplosion(){particleGeometry=new THREE.Geometry();for(var a=0;a<particleCount;a++){var c=new THREE.Vector3();particleGeometry.vertices.push(c)}var b=new THREE.ParticleBasicMaterial({color:16775930,size:0.2});particles=new THREE.Points(particleGeometry,b);scene.add(particles);particles.visible=true}function addDevTools(){var a=new THREE.AxesHelper(500);scene.add(a)}window.onload=function(){startGame();loop()};